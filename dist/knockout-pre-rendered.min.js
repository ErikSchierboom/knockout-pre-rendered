!function(e,t){"function"==typeof define&&define.amd?define(["knockout"],t):"object"==typeof exports?module.exports=t(require("knockout")):e.KnockoutElse=t(e.ko)}(this,function(e){"use strict";function t(e){return!!e&&"object"==typeof e&&e.constructor===Object}function n(e){return 8==e.nodeType&&v.test(g?e.text:e.nodeValue)}function i(e){return e&&e.nodeType&&1===e.nodeType}function s(e,t){return"string"==typeof e?i(t)&&t.attributes&&t.attributes[e]:i(t)}function a(t,n){return e.utils.arrayFirst(e.virtualElements.childNodes(t),s.bind(this,n))}function o(t,n){return e.utils.arrayFilter(e.virtualElements.childNodes(t),s.bind(this,n))}function r(t,n,i,s){var o,n,r=document.createElement("div");if(t.content)o=t.content;else if("SCRIPT"===t.tagName)if(t.innerHTML.match(/<tr[\s\S]*?<\/tr>/g)){var l=document.createElement("div"),h="<table><tbody>"+t.innerHTML+"</tbody></table>";l.innerHTML=h,o=l.firstChild.tBodies[0]}else o=document.createElement("div"),o.innerHTML=t.innerHTML;else o=t;for(var u=a(o,n?null:"data-template"),d=0,c=u;d<s;d++){var f=c;r.insertBefore(c.cloneNode(!0),null);do c=c.nextElementSibling||c.nextSibling;while(c&&1!==c.nodeType);i&&e.removeNode(f)}return r}function l(e,t){return{status:"existing",value:e,index:t}}function h(t){this.element=t.element,this.container=n(this.element)?this.element.parentNode:this.element,this.$context=t.$context,this.data=t.data,this.as=t.as,this.createElement=t.createElement,this.noContext=t.noContext,this.namedTemplate=void 0!==t.name,this.nodesPerElement=t.nodesPerElement||1,this.templateNode=r(t.name?document.getElementById(t.name):t.element,this.namedTemplate,!t.name,this.nodesPerElement),this.afterQueueFlush=t.afterQueueFlush,this.beforeQueueFlush=t.beforeQueueFlush,this.dataChanged=t.dataChanged,this.changeQueue=[],this.lastNodesList=[],this.childContexts=[],this.indexesToDelete=[],this.rendering_queued=!1,this.existingElements=o(this.namedTemplate?this.element:this.container,this.namedTemplate?null:"data-init"),"function"==typeof this.createElement&&this.createElements();var i=e.unwrap(this.data);this.onArrayChange(e.utils.arrayMap(i,l)),e.isObservable(this.data)&&(this.data.indexOf||(this.data=this.data.extend({trackArrayChanges:!0})),this.changeSubs=this.data.subscribe(this.onArrayChange,this,"arrayChange"))}function u(e){return e.offsetWidth<=0&&e.offsetHeight<=0||e.style&&e.style.display&&"none"==e.style.display}function d(e){return t(e)&&void 0===e.value&&void 0===e.convert&&void 0===e.field}function c(e,t){for(var n in e)e.hasOwnProperty(n)&&t[n](e[n])}function f(e){return e.get("attr")}function m(i,s,a){var o=n(i)?e.virtualElements.firstChild(i):i,r=a.get("attr");for(var l in r)if(r.hasOwnProperty(l)){if(void 0===o.attributes[l])continue;var h=o.attributes[l].value;t(s)&&"function"==typeof s.convert&&(h=s.convert(h)),r[l](h)}}function p(i,s,a){var o=n(i)?e.virtualElements.firstChild(i):i,r=e.utils.peekObservable(s),l=t(s)&&void 0!==s.value?s.value:a.get("checked")?o.checked:a.get("visible")?!u(o):a.get("html")?o.innerHTML:a.get("enable")?!o.disabled:a.get("disable")?o.disabled:o.innerText||o.textContent||o.value;t(s)&&"function"==typeof s.convert&&(l=s.convert(l));var h=(e.isObservable(s)?s:void 0)||(t(s)?s.field:void 0)||a.get("text")||a.get("textInput")||a.get("value")||a.get("checked")||a.get("html")||a.get("visible")||a.get("enable")||a.get("disable");h(l,r)}var g=window.document&&"<!--test-->"===window.document.createComment("test").text,v=g?/^<!--\s*ko(?:\s+([\s\S]+))?\s*-->$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/;h.animateFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},h.prototype.dispose=function(){this.changeSubs&&this.changeSubs.dispose()},h.prototype.onArrayChange=function(t){var n=this,i={added:[],existing:[],deleted:[]};e.utils.arrayForEach(t,function(e){i[e.status].push(e)}),"function"==typeof this.dataChanged&&this.dataChanged(i),i.deleted.length>0&&(this.changeQueue.push.apply(this.changeQueue,i.deleted),this.changeQueue.push({status:"clearDeletedIndexes"})),this.changeQueue.push.apply(this.changeQueue,i.existing),this.changeQueue.push.apply(this.changeQueue,i.added),this.changeQueue.length>0&&!this.rendering_queued&&(this.rendering_queued=!0,h.animateFrame.call(window,function(){n.processQueue()}))},h.prototype.processQueue=function(){var t=this;"function"==typeof this.beforeQueueFlush&&this.beforeQueueFlush(this.changeQueue),e.utils.arrayForEach(this.changeQueue,function(e){t[e.status](e.index,e.value)}),this.rendering_queued=!1,"function"==typeof this.afterQueueFlush&&this.afterQueueFlush(this.changeQueue),this.changeQueue=[]},h.prototype.createChildContext=function(t,n){return this.noContext?this.$context.extend({$item:n}):this.$context.createChildContext(n,this.as||null,function(n){n.$index=e.observable(t)})},h.prototype.existing=function(t,n){for(var i,s=this.childContexts[t]=this.createChildContext(t,n),a=t*this.nodesPerElement,o=0;o<this.nodesPerElement;o++)i=this.existingElements[a+o],e.applyBindings(s,i);this.lastNodesList.splice(t,0,i)},h.prototype.added=function(t,n){var i=this.lastNodesList[t-1]||null,s=this.templateNode.cloneNode(!0),a=e.virtualElements.childNodes(s);this.lastNodesList.splice(t,0,a[a.length-1]),this.childContexts[t]=this.createChildContext(t,n),e.applyBindingsToDescendants(this.childContexts[t],s);for(var o=a.length-1;o>=0;--o){var r=a[o];if(!r)return;e.virtualElements.insertAfter(this.element,r,i)}},h.prototype.deleted=function(t,n){var i=this.lastNodesList[t],s=this.lastNodesList[t-1]||this.element;do i=i.previousSibling,e.removeNode(i&&i.nextSibling||e.virtualElements.firstChild(this.element));while(i&&i!==s);this.lastNodesList[t]=this.lastNodesList[t-1],this.indexesToDelete.push(t)},h.prototype.clearDeletedIndexes=function(){for(var e=this.indexesToDelete.length-1;e>=0;--e)this.lastNodesList.splice(this.indexesToDelete[e],1),this.childContexts.splice(this.indexesToDelete[e],1);for(var t=this.childContexts.length-1;t>=0;--t)this.childContexts[t]&&this.childContexts[t].$index&&this.childContexts[t].$index(t);this.indexesToDelete=[]},h.prototype.createElements=function(){for(var t=[],n=0;n<this.existingElements.length/this.nodesPerElement;n++)t.push(this.createElement());e.isObservable(this.data)?this.data(t):e.utils.arrayForEach(t,function(e){this.data.push(e)})},e.bindingHandlers.foreachInit={init:function(n,i,s,a,o){var r,l=i();return t(l)?(l.element=l.element||n,l.$context=o,r=new h(l)):r=new h({element:n,data:e.unwrap(o.$rawData)===l?o.$rawData:l,$context:o,createElement:l.createElement}),e.utils.domNodeDisposal.addDisposeCallback(n,function(){r.dispose()}),{controlsDescendantBindings:!0}},InitializedForeach:h},e.virtualElements.allowedBindings.foreachInit=!0,e.bindingHandlers.init={init:function(e,t,n,i){var s=t();d(s)?c(s,i):f(n)?m(e,s,n):p(e,s,n)}},e.virtualElements.allowedBindings.init=!0});